#!/usr/bin/perl
# URL-encodes or -decodes a string.
# This is a rewrite of a bash script that did the same thing.
# Written by ayekat on a boring tuesday morning in februrary 2013.

use File::Basename;
my $command = $ARGV[0];

if ($command eq 'encode') {
	my $string = <STDIN>;
	$string =~ s/\R//g;
	$string =~ s/([^A-Za-z0-9+\-_])/sprintf("%%%02X", ord($1))/eg;
	print $string."\n";
} elsif ($command eq 'decode') {
	my $string = <STDIN>;
	$string =~ s/\R//g;
	$string =~ s/\%([A-Fa-f0-9]{2})/pack('C', hex($1))/eg;
	print $string."\n";
} else {
	printf("Usage: %s encode|decode\n", basename($0));
}
