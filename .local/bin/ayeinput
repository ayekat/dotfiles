#!/usr/bin/env sh

# Set the X input according to ayekat's preferences.
# Written by ayekat on an annoying Monday afternoon in May 2015.

# TODO accept options and make it more generic.
# The goal is to have a generic wrapper for
# * setxkbmap
# * xmodmap
# * mouse (with xinput and xmodmap)

[ -n "$XDG_CONFIG_HOME" ] || XDG_CONFIG_HOME="$HOME/.config"

# Swiss keyboard layout:
setxkbmap -layout ch -option caps:swapescape

# ... with minor tweakings:
xmodmap $XDG_CONFIG_HOME/X11/xmodmaprc

# Keyboard/host-specific mouse button settings:
if [ "$(hostname)" = 'ixh' ]; then
	dev='TPPS/2 IBM TrackPoint'
	ptr='3 2 1 4 5 6 7 8 9 10'
	tmo='200'
else
	dev='pointer:Lenovo ThinkPad Compact USB Keyboard with TrackPoint'
	ptr='3 2 1 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22'
	tmo='0'
fi
xmodmap -e "pointer = $ptr"

# Enable scrolling through middle click + trackpad:
xinput set-prop "$dev" 'Evdev Wheel Emulation' 1
xinput set-prop "$dev" 'Evdev Wheel Emulation Button' 2
xinput set-prop "$dev" 'Evdev Wheel Emulation Axes' 6 7 4 5
xinput set-prop "$dev" 'Evdev Wheel Emulation Timeout' $tmo

# Enable middle click drag&drop (work-around for above option):
xinput set-prop "$dev" 'Evdev Middle Button Emulation' 1
