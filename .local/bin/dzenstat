#!/usr/bin/env bash
# Start and position dzenstat/dzen2 to the right places.
# Written by ayekat, improved in october 2013.

# calculate offset depending on tag width:
tagwidth=120

dzenstat_draw() {
	[ ! -x "$HOME"/dev/dzenstat/dzenstat ] && return 1
	cd "$HOME"/dev/dzenstat
	./dzenstat | dzen2 -xs $1 -ta right -x "$tagwidth" &
	dynenv DZEN2_ID_"$1"=$(($(jobs -p)+1))
	disown
}

dzenstat_start() {
	dzenstat_draw 1
	[ $(dynenv NUM_SCREENS) -eq 2 ] && dzenstat_draw 2
}

dzenstat_stop() {
	kill $(dynenv DZEN2_ID_1)
	[ $(dynenv NUM_SCREENS) -eq 2 ] && kill $(dynenv DZEN2_ID_2)
}

dzenstat_help() {
	echo "$(basename "$0") start|stop|restart"
}

case "$1" in
	start)
		dzenstat_start;;

	stop)
		dzenstat_stop;;

	restart)
		dzenstat stop
		dzenstat start;;

	*)
		dzenstat_help
esac

